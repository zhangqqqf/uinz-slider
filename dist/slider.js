'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=require('react');var _react2=_interopRequireDefault(_react);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Slider=function(_Component){_inherits(Slider,_Component);function Slider(props){_classCallCheck(this,Slider);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Slider).call(this,props));_this.style={container:{position:'relative',overflow:'hidden',cursor:'-webkit-grab'},indicateBox:{position:'absolute',width:'100%',bottom:'0',textAlign:'center'},indicateDot:{display:'inline-block',width:'10px',height:'10px',borderRadius:'50%',background:'rgba(255,255,255,.5)',margin:'10px 5px',transition:'all .5s',WebkitTransition:'all .5s'},scroller:{whiteSpace:'nowrap',transition:'transform .5s',WebkitTransition:'transform .5s'},img:{width:'100%',display:'inline-block'}};_this.moveInfo={active:false,startX:0,diffX:0,translateX:0,endX:0,startTime:0,endTime:0,max:0,min:0};_this.initData=function(){var container=_this.refs.container;_this.moveInfo.containerWidth=container.offsetWidth;_this.moveInfo.picNum=_this.props.images.length;_this.moveInfo.maxX=-(_this.moveInfo.containerWidth*(_this.moveInfo.picNum-1)+20);_this.moveInfo.minX=20};_this.onMoveStart=function(x,y){var _this$refs=_this.refs;var container=_this$refs.container;var scroller=_this$refs.scroller;_this.moveInfo.startX=x;_this.moveInfo.active=true;_this.moveInfo.startTime=Date.now();container.style.cursor='-webkit-grabbing';scroller.style.transition='none';scroller.style.webkitTransition='none'};_this.onMove=function(x,y){var _this$refs2=_this.refs;var container=_this$refs2.container;var scroller=_this$refs2.scroller;var _this$moveInfo=_this.moveInfo;var startX=_this$moveInfo.startX;var endX=_this$moveInfo.endX;var translateX=_this$moveInfo.translateX;var minX=_this$moveInfo.minX;var maxX=_this$moveInfo.maxX;var active=_this$moveInfo.active;if(!active)return;_this.moveInfo.diffX=startX-x;var _translateX=endX-_this.moveInfo.diffX;_translateX=_translateX>minX?minX:_translateX<maxX?maxX:_translateX;_this.moveInfo.translateX=_translateX;scroller.style.transform='translate('+_translateX+'px)';scroller.style.webkitTransform='translate('+_translateX+'px)'};_this.onMoveEnd=function(e){var _this$refs3=_this.refs;var container=_this$refs3.container;var scroller=_this$refs3.scroller;container.style.cursor='-webkit-grab';var index=_this.state.index;var _this$moveInfo2=_this.moveInfo;var translateX=_this$moveInfo2.translateX;var startTime=_this$moveInfo2.startTime;var picNum=_this$moveInfo2.picNum;var diffX=_this$moveInfo2.diffX;var minX=_this$moveInfo2.minX;var maxX=_this$moveInfo2.maxX;var containerWidth=_this$moveInfo2.containerWidth;_this.moveInfo.active=false;var diffTime=Date.now()-startTime;var rate=Math.abs(diffX/diffTime);var _index=void 0;if(rate>0.5&&translateX<minX&&translateX>maxX){if(diffX>0){if(index!=picNum-1){_index=index+1}}else {if(index!==0){_index=index-1}}}else {_index=Number(Math.abs(translateX/containerWidth).toFixed(0))}_this.moveInfo.endX=-1*_index*containerWidth;_this.setState({index:_index});scroller.style.transition='transform .5s';scroller.style.webkitTransition='transform .5s';scroller.style.transform='translateX('+_this.moveInfo.endX+'px)';scroller.style.webkitTransform='translateX('+_this.moveInfo.endX+'px)';_this.moveInfo.diffX=0};_this.autoScroll=function(){var autoTime=_this.props.autoTime;var _this$moveInfo3=_this.moveInfo;var containerWidth=_this$moveInfo3.containerWidth;var picNum=_this$moveInfo3.picNum;var active=_this$moveInfo3.active;var scroller=_this.refs.scroller;_this.intervel=setTimeout(function(){if(active)return _this.autoScroll();var _index=_this.state.index+1;_index=_index>picNum-1?0:_index;_this.setState({index:_index});_this.moveInfo.endX=-1*_index*containerWidth;scroller.style.transform='translateX('+_this.moveInfo.endX+'px)';scroller.style.webkitTransform='translateX('+_this.moveInfo.endX+'px)';_this.autoScroll()},autoTime)};_this.state={index:0};return _this}_createClass(Slider,[{key:'componentDidMount',value:function componentDidMount(){var _this2=this;var container=this.refs.container;var auto=this.props.auto;this.initData();window.addEventListener('resize',function(){_this2.initData();_this2.onMoveEnd()});container.addEventListener('touchstart',function(e){var _e$touches$=e.touches[0];var x=_e$touches$.pageX;var y=_e$touches$.pageY;_this2.onMoveStart(x,y)});container.addEventListener('touchmove',function(e){var _e$touches$2=e.touches[0];var x=_e$touches$2.pageX;var y=_e$touches$2.pageY;_this2.onMove(x,y)});container.addEventListener('touchend',this.onMoveEnd);container.addEventListener('mousedown',function(e){e.preventDefault();_this2.onMoveStart(e.pageX,e.pageY)});container.addEventListener('mousemove',function(e){e.preventDefault();_this2.onMove(e.pageX,e.pageY)});container.addEventListener('mouseleave',function(e){_this2.onMoveEnd(e.pageX,e.pageY)});container.addEventListener('mouseup',function(e){_this2.onMoveEnd(e.pageX,e.pageY)});auto&&this.autoScroll()}},{key:'render',value:function render(){var index=this.state.index;var images=this.props.images;var style=this.style;return _react2.default.createElement('div',{style:style.container,ref:'container'},_react2.default.createElement('div',{style:style.scroller,ref:'scroller'},images.map(function(src,i){return _react2.default.createElement('img',{key:i,style:style.img,src:src})})),_react2.default.createElement('div',{style:style.indicateBox},images.map(function(_,i){var activeStyle=Object.assign({},style.indicateDot,{background:'rgba(255,255,255,.9)'});return _react2.default.createElement('span',{key:i,style:i===index?activeStyle:style.indicateDot})})))}}]);return Slider}(_react.Component);Slider.defaultProps={index:0,auto:false,autoTime:3000,images:[]};exports.default=Slider;